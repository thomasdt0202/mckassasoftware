<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MuseumCatering Kassa V26</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg-app: #f1f5f9; --bg-panel: #ffffff; --text-main: #0f172a; --text-muted: #64748b; --border: #e2e8f0; --col-primary: #0f172a; --col-accent: #2563eb; --col-success: #16a34a; --col-warning: #f59e0b; --col-danger: #ef4444; --radius: 12px; --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); --gold: #ffd700; }
        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; margin: 0; background: var(--bg-app); height: 100dvh; display: flex; overflow: hidden; color: var(--text-main); }
        
        /* Grote Knoppen Layout */
        .left-panel { flex: 65; display: flex; flex-direction: column; padding: 15px; gap: 12px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; flex: 1; overflow-y: auto; padding-bottom: 20px; align-content: start; }
        
        .p-card { background: white; border-radius: var(--radius); padding: 12px; height: 110px; position: relative; display: flex; flex-direction: column; justify-content: space-between; border: 2px solid transparent; transition: 0.1s; cursor: pointer; box-shadow: var(--shadow); }
        .p-card:active { transform: scale(0.95); background: #e2e8f0; }
        .p-name { font-weight: 800; font-size: 0.95rem; line-height: 1.2; }
        .p-price { font-weight: 600; color: var(--text-muted); font-size: 0.9rem; align-self: flex-end; }

        /* Goud Randje Effect voor Zoetigheden */
        .suggest-gold { 
            border: 3px solid var(--gold) !important; 
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); 
            animation: goldPulse 1.5s infinite; 
            z-index: 10;
        }
        @keyframes goldPulse { 
            0% { transform: scale(1); } 
            50% { transform: scale(1.03); } 
            100% { transform: scale(1); } 
        }

        /* De rest van de styling (overgenomen van je origineel) */
        .right-panel { flex: 35; background: white; display: flex; flex-direction: column; border-left: 1px solid var(--border); z-index: 20; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; background: white; padding: 12px 18px; border-radius: var(--radius); box-shadow: var(--shadow); }
        .cat-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .cat-btn { padding: 14px 22px; background: white; border-radius: 10px; font-weight: 800; color: var(--text-muted); border: 1px solid var(--border); white-space: nowrap; }
        .cat-btn.active { background: var(--col-primary); color: white; }
        .cart-list { flex: 1; overflow-y: auto; padding: 15px; }
        .total-display { text-align: right; font-size: 2.8rem; font-weight: 900; }
        .btn-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 10px; height: 85px; }
        .btn-main { border-radius: 15px; font-weight: 900; font-size: 1.2rem; color: white; }
        .btn-cash { background: var(--col-accent); }
        .btn-pin { background: var(--col-success); }
        
        #flash { position: fixed; inset: 0; background: rgba(22, 163, 74, 0.9); z-index: 5000; display: none; align-items: center; justify-content: center; }
        .checkmark { font-size: 8rem; color: white; font-weight: 900; }
        
        /* Modal styling */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 100; }
        .modal-card { background: white; width: 500px; border-radius: 20px; padding: 25px; }
    </style>
</head>
<body>

<div id="flash"><div class="checkmark">✓</div></div>

<div class="app-container">
    <div class="left-panel">
        <div class="top-bar">
            <div style="font-weight: 800; font-size: 1.4rem;">MuseumCatering</div>
            <div id="clock" style="font-weight: 600;">00:00</div>
        </div>
        <div class="cat-scroll" id="catTabs"></div>
        <div class="product-grid" id="prodGrid"></div>
    </div>
    
    <div class="right-panel">
        <div style="padding: 15px; font-weight: 800; border-bottom: 1px solid var(--border);">Huidige Bon</div>
        <div class="cart-list" id="cartList"></div>
        <div style="padding: 20px; border-top: 1px solid var(--border);">
            <div class="total-display" id="totalDisplay">€ 0,00</div>
            <div class="btn-grid">
                <button class="btn-main btn-cash" onclick="payCash()">CASH</button>
                <button class="btn-main btn-pin" onclick="payPin()">PIN</button>
            </div>
            <button id="btnClear" onclick="clearCart()" style="margin-top:15px; width:100%; padding:10px; background:none; color:var(--col-danger); font-weight:bold;">Bon Wissen</button>
        </div>
    </div>
</div>

<script>
    const GOOGLE_URL = "JOUW_WEB_APP_URL_HIER";
    
    const products = [
        {c:0, n:"Cola", p:3.50}, {c:0, n:"Spa Blauw", p:3.50}, {c:0, n:"Verse Jus", p:5.25},
        {c:1, n:"Koffie", p:3.40}, {c:1, n:"Cappuccino", p:3.75}, {c:1, n:"Thee", p:3.50},
        {c:3, n:"Appeltaart", p:5.50}, {c:3, n:"Worteltaart", p:5.50}, {c:3, n:"Citroen Meringue", p:5.50},
        {c:4, n:"Br. Oude Kaas", p:9.50}, {c:4, n:"Soep", p:6.50}
    ];

    let cart = [];
    let activeCat = 0;
    let isTransactionInProgress = false;

    function renderCats() {
        const cats = ["Fris", "Warm", "Alcohol", "Zoet", "Eten", "Divers"];
        document.getElementById('catTabs').innerHTML = cats.map((name, i) => 
            `<button class="cat-btn ${i===activeCat?'active':''}" onclick="setCat(${i})">${name}</button>`).join('');
    }

    function setCat(id) { activeCat = id; renderGrid(); renderCats(); }

    function renderGrid() {
        const grid = document.getElementById('prodGrid');
        const items = products.filter(p => p.c === activeCat);
        grid.innerHTML = items.map(p => {
            // Check of dit item een zoetigheid is (Cat 3) voor de gouden rand
            const goldClass = (p.c === 3) ? 'suggest-target' : '';
            return `<div class="p-card ${goldClass}" onclick="addToCart('${p.n}', ${p.p}, ${p.c})">
                <div class="p-name">${p.n}</div>
                <div class="p-price">€ ${p.p.toFixed(2)}</div>
            </div>`;
        }).join('');
    }

    function addToCart(n, p, catId) {
        let exist = cart.find(x => x.n === n);
        if(exist) exist.qty++; else cart.push({n, p, qty:1});
        
        // Goud randje trigger bij Warme Drank (Cat 1)
        if(catId === 1) {
            triggerGoldEffect();
        }
        
        renderCart();
    }

    function triggerGoldEffect() {
        // Zoek alle zoetigheid-kaarten die op dit moment in beeld zijn
        const targets = document.querySelectorAll('.suggest-target');
        targets.forEach(el => el.classList.add('suggest-gold'));
        
        // Ook de tab "Zoet" een seintje geven als die niet actief is
        const zoetTab = document.querySelectorAll('.cat-btn')[3];
        if(zoetTab) zoetTab.style.borderColor = "var(--gold)";

        setTimeout(() => {
            targets.forEach(el => el.classList.remove('suggest-gold'));
            if(zoetTab) zoetTab.style.borderColor = "var(--border)";
        }, 5000);
    }

    function renderCart() {
        const list = document.getElementById('cartList');
        list.innerHTML = cart.map(item => `
            <div style="display:flex; justify-content:space-between; margin-bottom:10px; background:#f8fafc; padding:10px; border-radius:8px;">
                <span><b>${item.qty}x</b> ${item.n}</span>
                <span>€ ${(item.p * item.qty).toFixed(2)}</span>
            </div>
        `).join('');
        
        let total = cart.reduce((a,b) => a + (b.p*b.qty), 0);
        document.getElementById('totalDisplay').innerText = `€ ${total.toFixed(2)}`;
    }

    function payPin() { finishTransaction("PIN"); }
    function payCash() { finishTransaction("CONTANT"); }

    function finishTransaction(type) {
        if(cart.length === 0 || isTransactionInProgress) return;
        isTransactionInProgress = true;

        // Flash effect
        const f = document.getElementById('flash');
        f.style.display = 'flex';
        setTimeout(() => { f.style.display = 'none'; }, 600);

        let total = cart.reduce((a,b) => a + (b.p*b.qty), 0);
        let itemsFlat = cart.map(c => `${c.qty}x ${c.n}`).join(", ");

        const data = {
            time: new Date().toLocaleTimeString('nl-NL', {hour:'2-digit', minute:'2-digit'}),
            type: type,
            total: total,
            items: [itemsFlat]
        };

        // Versturen naar Google (zonder no-cors voor betere betrouwbaarheid)
        fetch(GOOGLE_URL, {
            method: 'POST',
            body: JSON.stringify(data)
        }).catch(e => console.log("Offline backup nodig"));

        // Reset
        cart = [];
        renderCart();
        renderGrid();
        setTimeout(() => { isTransactionInProgress = false; }, 1200);
    }

    function clearCart() { if(confirm("Bon wissen?")) { cart = []; renderCart(); renderGrid(); } }

    window.onload = () => { renderCats(); renderGrid(); };
</script>

</body>
</html>
